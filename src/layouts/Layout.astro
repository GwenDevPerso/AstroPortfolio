---
import LanguagePicker from '../components/LanguagePicker.astro';
import Nav from '../components/Nav.astro';
import {getLangFromUrl} from '../i18n/utils';

export interface Props {
    title?: string;
    lang?: string;
}

const {title = 'Astro', lang} = Astro.props;
const currentLang = lang || getLangFromUrl(Astro.url);
---

<!doctype html>
<html lang={currentLang}>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
    </head>
    <body>
        <Nav />
        <LanguagePicker />
        <div id="cursor-light"></div>

        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <div class="firefly"></div>
        <slot />
    </body>
</html>

<script>
    // Effet de lumière qui suit le curseur
    const cursorLight = document.getElementById('cursor-light');

    document.addEventListener('mousemove', (e) => {
        if (cursorLight) {
            cursorLight.style.left = e.clientX + 'px';
            cursorLight.style.top = e.clientY + 'px';
        }
    });

    // Masquer l'effet quand la souris quitte la fenêtre
    document.addEventListener('mouseleave', () => {
        if (cursorLight) {
            cursorLight.style.opacity = '0';
        }
    });

    // Réafficher l'effet quand la souris revient
    document.addEventListener('mouseenter', () => {
        if (cursorLight) {
            cursorLight.style.opacity = '1';
        }
    });
</script>

<style>
    html,
    body {
        margin: 0;
        width: 100%;
        height: 100%;
        font-family: system-ui, sans-serif;
        background: #070918;
        color: #fffef9;
    }

    /* Ajout de l'effet de lumière (glow) qui suit le curseur */
    #cursor-light {
        position: fixed;
        width: 300px;
        height: 300px;
        border-radius: 50%;
        background: radial-gradient(
            circle,
            rgba(105, 25, 255, 0.15) 0%,
            rgba(105, 25, 255, 0.1) 25%,
            rgba(105, 25, 255, 0.05) 50%,
            rgba(255, 255, 255, 0) 70%
        );
        pointer-events: none;
        transform: translate(-50%, -50%);
        z-index: 9999;
        transition: opacity 0.3s;
        mix-blend-mode: screen;
    }

    .firefly {
        position: fixed;
        width: 0.4vw;
        height: 0.4vw;
        background: #6919ff;
        border-radius: 50%;
        z-index: 1;
        pointer-events: none;
    }

    .firefly::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: #6919ff;
        box-shadow: 0 0 2vw 0.4vw #6919ff;
        animation: flash 3s ease-in-out infinite;
    }

    .firefly:nth-child(1) {
        left: 10%;
        top: 50%;
        animation: move-1 20s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(2) {
        left: 20%;
        top: 20%;
        animation: move-2 25s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(3) {
        left: 30%;
        top: 80%;
        animation: move-3 30s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(4) {
        left: 40%;
        top: 30%;
        animation: move-4 35s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(5) {
        left: 50%;
        top: 70%;
        animation: move-5 40s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(6) {
        left: 60%;
        top: 40%;
        animation: move-1 45s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(7) {
        left: 70%;
        top: 60%;
        animation: move-2 50s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(8) {
        left: 80%;
        top: 10%;
        animation: move-3 55s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(9) {
        left: 90%;
        top: 90%;
        animation: move-4 60s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(10) {
        left: 15%;
        top: 85%;
        animation: move-5 65s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(11) {
        left: 25%;
        top: 35%;
        animation: move-1 70s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(12) {
        left: 35%;
        top: 65%;
        animation: move-2 75s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(13) {
        left: 45%;
        top: 15%;
        animation: move-3 80s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(14) {
        left: 55%;
        top: 95%;
        animation: move-4 85s ease-in-out infinite;
        opacity: 1;
    }
    .firefly:nth-child(15) {
        left: 65%;
        top: 25%;
        animation: move-5 90s ease-in-out infinite;
        opacity: 1;
    }

    @keyframes move-1 {
        0%,
        100% {
            transform: translate(0, 0) rotate(0deg);
        }
        25% {
            transform: translate(10vw, -15vh) rotate(90deg);
        }
        50% {
            transform: translate(15vw, 10vh) rotate(180deg);
        }
        75% {
            transform: translate(-5vw, -5vh) rotate(270deg);
        }
    }

    @keyframes move-2 {
        0%,
        100% {
            transform: translate(0, 0) rotate(0deg);
        }
        25% {
            transform: translate(-15vw, 15vh) rotate(90deg);
        }
        50% {
            transform: translate(5vw, -10vh) rotate(180deg);
        }
        75% {
            transform: translate(10vw, 5vh) rotate(270deg);
        }
    }

    @keyframes move-3 {
        0%,
        100% {
            transform: translate(0, 0) rotate(0deg);
        }
        25% {
            transform: translate(5vw, 20vh) rotate(90deg);
        }
        50% {
            transform: translate(-20vw, -5vh) rotate(180deg);
        }
        75% {
            transform: translate(15vw, 10vh) rotate(270deg);
        }
    }

    @keyframes move-4 {
        0%,
        100% {
            transform: translate(0, 0) rotate(0deg);
        }
        25% {
            transform: translate(-10vw, -15vh) rotate(90deg);
        }
        50% {
            transform: translate(15vw, 5vh) rotate(180deg);
        }
        75% {
            transform: translate(-5vw, 20vh) rotate(270deg);
        }
    }

    @keyframes move-5 {
        0%,
        100% {
            transform: translate(0, 0) rotate(0deg);
        }
        25% {
            transform: translate(10vw, 10vh) rotate(90deg);
        }
        50% {
            transform: translate(-15vw, -20vh) rotate(180deg);
        }
        75% {
            transform: translate(20vw, 15vh) rotate(270deg);
        }
    }

    @keyframes flash {
        0%,
        100% {
            opacity: 0.2;
            box-shadow: 0 0 0vw 0vw #6919ff;
        }
        50% {
            opacity: 1;
            box-shadow: 0 0 2vw 0.4vw #6919ff;
        }
    }
</style>
